---
interface Props {
  username?: string;
  title?: string;
}

const {
  username = "astromikemassimino",
  title = "Follow Mike",
} = Astro.props;
---

<div class="instagram-sidebar-card overflow-hidden rounded-xl bg-white p-3 shadow-2xl border border-gray-100">
  <div class="mb-2 flex items-center justify-between border-b border-gray-50 pb-2">
    <h3 class="font-exo text-sm font-bold text-red uppercase tracking-widest">
      {title}
    </h3>
    <a href={`https://instagram.com/${username}`} target="_blank" class="text-[12px] font-roboto text-blue-600 hover:underline font-bold">
      INSTAGRAM
    </a>
  </div>

  <div class="instagram-scaler-container">
    <blockquote
      class="instagram-media"
      data-instgrm-permalink={`https://www.instagram.com/${username}/?utm_source=ig_embed&utm_campaign=loading`}
      data-instgrm-version="14"
    >
      <div class="p-4 text-center text-xs text-gray-400">Loading Feed...</div>
    </blockquote>
  </div>

  <a
    href={`https://www.instagram.com/${username}/`}
    target="_blank"
    class="mt-3 block w-full rounded-lg bg-gradient-to-r from-[#DA5F6B] via-[#E38A4C] to-[#F0CB78] py-2 text-center font-jost text-xs font-bold text-white shadow-md hover:brightness-110 transition-all"
  >
    FOLLOW @{username.toUpperCase()}
  </a>
</div>

<style>
  /* Overall Sidebar Width */
  .instagram-sidebar-card {
    width: 100%;
  }

  @media (min-width: 1536px) {
    .instagram-sidebar-card {
      width: 300px;
    }
  }

  /* Shrink the embed by 25% (0.75 scale) */
  .instagram-scaler-container {
    width: 100%;
    height: 500px; /* Limits vertical space */
    overflow-y: auto;
    overflow-x: hidden;
    scrollbar-width: none;
  }

  @media (min-width: 1536px) {
    .instagram-scaler-container {
      height: 350px;
    }
  }

  /* Targets the iframe generated by Instagram's script */
  .instagram-scaler-container :global(iframe) {
    transform: scale(0.79) !important;
    transform-origin: top left !important;
    width: 190% !important; /* Math: (1 / 0.72) * 100 to fill width */
    min-width: 326px !important;
  }

  @media (max-width: 1535px) {
    .instagram-scaler-container :global(iframe) {
      transform: scale(1) !important;
      width: 100% !important;
      min-width: unset !important;
    }
  }

  .instagram-media {
    margin: 0 !important;
    border: none !important;
  }
</style>

<script is:inline>
  if (!window.instgrm) {
    const script = document.createElement("script");
    script.src = "https://www.instagram.com/embed.js";
    script.async = true;
    document.body.appendChild(script);
  } else {
    window.instgrm.Embeds.process();
  }
</script>